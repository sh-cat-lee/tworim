# 2장 - 리팩터링 원칙 🚧

2.1 리팩터링 정의
2.2 두 개의 모자
2.3 리팩터링하는 이유
2.4 언제 리팩터링해야 할까?
2.5 리팩터링 시 고려할 문제
2.6 리팩터링, 아키텍처, 애그니(YAGNI)
2.7 리팩터링과 소프트웨어 개발 프로세스
2.8 리팩터링과 성능
2.9 리팩터링의 유래
2.10 리팩터링 자동화
2.11 더 알고 싶다면

## 2.1 리팩터링 정의

리팩터링: [명사] 소프트웨어의 겉보기 동작은 그대로 유지한 채, 코드를 이해하고 수정하기 쉽도록 내부 구조를 변경하는 기법.

리팩터링하다: [동사] 소프트웨어의 겉보기 동작은 그대로 유지한 채, 여러 가지 리팩터링 기법을 적용해서 소프트웨어를 재구성한다.

리팩터링의 목적은 코드를 이해하고 수정하기 쉽게 만드는 것이다. Simply

## 2.2 두 개의 모자

기능추가 vs 리팩터링

명확히 구분하여 작업

리팩터링 할때는 리팩터링 모자를 쓴 다음 코드 재구성에만 전념(기능추가 X), 테스트도 새로 만들지 않는다. 인터페이스 변경시에만 기존 테스트 수정

## 2.3 리팩터링하는 이유

리팩터링하면 소프트웨어 설계가 좋아진다.

리팩터링하면 소프트웨어를 이해하기 쉬워진다.

리팩터링하면 버그를 쉽게 찾을 수 있다.

리팩터링하면 프로그래밍 속도를 높일 수 있다.

## 2.4 언제 리팩터링해야 할까?

- 3의 법칙 
  1. 처음에 그냥 한다. 
  2. 비슷한 일을 두 번째로 하게 되면, 일단 계속 진행
  3. 비슷한 일을 3번째 하게 되면 리팩터링

준비를 위한 리팩터링: 기능을 쉽게 추가하게 만들기

이해를 위한 리팩터링: 코드를 이해하기 쉽게 만들기

쓰레기 줍기 리팩터링

계획된 리팩터링과 수시로 하는 리팩터링
- 보기 싫은 코드를 발견하면 리팩터링하자. 그런데 잘 작성된 코드 역시 수많은 리팩터링을 거쳐야 한다.
- 무언가 수정하려 할 때는 먼저 수정하기 쉽게 정돈하고(만만치 않을 수 있다) 그런 다음 쉽게 수정하다.

오래걸리는 리팩터링

코드 리뷰에 리팩터링 활용하기

관리자에게는 뭐라고 말해야 할까?

리팩터링하지 말아야 할 때
- 외부 API 다루듯 호출해서 쓰는 코드라면 지저분해도 그냥 둔다.
- 리팩터링하는 것보다 처음부터 새로 작성하는 게 쉬울 때도 리팩터링하지 않는다.

## 2.5 리팩터링 시 고려할 문제

새 기능 개발 속도 저하

코드 소유권

브랜치

테스팅

레거시 코드

데이터베이스

## 2.6 리팩터링, 아키텍처, 애그니(YAGNI)

현재까지 파악한 요구사항만을 해결하는 소프트웨어를 구축한다. 단, 이 요구를 멋지게 해결할 수 있도록 설계한다. 진행하면서 사용자의 요구사항을 더 잘 이해하게 되면 아키텍처도 그에 맞게 리팩터링해서 바꾼다.
리팩터링을 미루면 훨씬 힘들어진다는 확신이 들 때만 유연성 메커니즘을 추가한다.

간결한 설계, 점진적 설계, YAGNI(You Aren't Going to Need It, 필요 없을거다)

## 2.7 리팩터링과 소프트웨어 개발 프로세스

테스트 코드와 리팩터링을 묶어서 테스트 주도 개발(TDD)

리팩터링의 첫 번째 토대는 자가 테스트 코드다.

팀으로 개발하면서 리팩터링을 하려면 각 팀원이 다른 사람의 작업을 방해하지 않으면서 언제든지 리팩터링할 수 있어야 한다.

자가 테스트 코드 역시 지속적 통합의 핵심 요소다. 따라서 자가 테스트 코드, 지속적 통합, 리팩터링으로는 세 기법은 서로 강력한 상승효과를 발휘한다.

## 2.8 리팩터링과 성능

리팩터링은 성능 좋은 소프트웨어를 만드는데 기여한다. 단기적으로 보면 리팩터링 단계에서는 성능이 느려질 수도 있다. 

하지만 최적화 단계에서 코드를 튜닝하기 훨씬 쉬워지기 때문에 결국 더 빠른 소프트웨어를 얻게 된다.